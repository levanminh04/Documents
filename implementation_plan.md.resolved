# ğŸ“‹ BÃO CÃO CHIáº¾N LÆ¯á»¢C KIáº¾N TRÃšC & Káº¾ HOáº CH TRIá»‚N KHAI v3.0

## Há»‡ Thá»‘ng BÃ¡n VÃ© & Flash Sale (TicketBox Clone)

> **Version**: 3.0 (Final)  
> **Tech Stack**: Spring Boot + ReactJS + Redis + Kafka + pgvector  
> **Team**: 2 ngÆ°á»i (1 BE chÃ­nh, 1 FE chÃ­nh)  
> **Thá»i gian**: 12 tuáº§n

---

# Má»¤C Lá»¤C

1. [Kiáº¿n TrÃºc Tá»•ng Quan](#1-kiáº¿n-trÃºc-tá»•ng-quan)
2. [Äiá»ƒm áº¤n TÆ°á»£ng Giáº£ng ViÃªn](#2-Ä‘iá»ƒm-áº¥n-tÆ°á»£ng-giáº£ng-viÃªn)
3. [Message Queue Architecture](#3-message-queue-architecture)
4. [Redis Distributed Lock - Flash Sale](#4-redis-distributed-lock---flash-sale)
5. [Refactoring Guide - Source Code Hiá»‡n Táº¡i](#5-refactoring-guide---source-code-hiá»‡n-táº¡i)
6. [Timeline Chi Tiáº¿t 12 Tuáº§n](#6-timeline-chi-tiáº¿t-12-tuáº§n)

---

# 1. KIáº¾N TRÃšC Tá»”NG QUAN

## 1.1. System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND LAYER                                  â”‚
â”‚                                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚                         ReactJS SPA                              â”‚      â”‚
â”‚    â”‚  â€¢ Vite + React 18 + TypeScript                                 â”‚      â”‚
â”‚    â”‚  â€¢ TailwindCSS / Ant Design                                     â”‚      â”‚
â”‚    â”‚  â€¢ React Query (data fetching)                                  â”‚      â”‚
â”‚    â”‚  â€¢ Keycloak-js (authentication)                                 â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ HTTP/HTTPS
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              API GATEWAY                                     â”‚
â”‚                                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚              Spring Cloud Gateway (:8080)                        â”‚      â”‚
â”‚    â”‚  â€¢ OAuth2 Resource Server (JWT validation)                      â”‚      â”‚
â”‚    â”‚  â€¢ Rate Limiting (Redis)                                        â”‚      â”‚
â”‚    â”‚  â€¢ Circuit Breaker                                              â”‚      â”‚
â”‚    â”‚  â€¢ Request routing                                              â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚                            â”‚
        â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Service  â”‚           â”‚ Core Service  â”‚           â”‚  AI Service   â”‚
â”‚   (:8081)     â”‚           â”‚   (:8082)     â”‚           â”‚   (:8085)     â”‚
â”‚   MongoDB     â”‚           â”‚  PostgreSQL   â”‚           â”‚   pgvector    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Auth/Profileâ”‚           â”‚ â€¢ Event       â”‚           â”‚ â€¢ Chatbot     â”‚
â”‚ â€¢ Keycloak    â”‚           â”‚ â€¢ Booking     â”‚           â”‚ â€¢ RAG         â”‚
â”‚   integration â”‚           â”‚ â€¢ Payment     â”‚           â”‚ â€¢ Recommend   â”‚
â”‚ â€¢ User roles  â”‚           â”‚ â€¢ Ticket/QR   â”‚           â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                            â”‚                            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INFRASTRUCTURE LAYER                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Kafka     â”‚  â”‚    Redis     â”‚  â”‚   Keycloak   â”‚  â”‚   Eureka     â”‚    â”‚
â”‚  â”‚  (Messages)  â”‚  â”‚ (Lock/Cache) â”‚  â”‚    (Auth)    â”‚  â”‚ (Discovery)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚  PostgreSQL  â”‚  â”‚   MongoDB    â”‚  â”‚Config Server â”‚                      â”‚
â”‚  â”‚  (Core, AI)  â”‚  â”‚   (User)     â”‚  â”‚   (Config)   â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1.2. Service Responsibilities

| Service | Port | Database | Responsibilities |
|---------|------|----------|------------------|
| **API Gateway** | 8080 | - | Routing, JWT validation, Rate limit |
| **User Service** | 8081 | MongoDB | Auth, Profile, Roles, Keycloak sync |
| **Core Service** | 8082 | PostgreSQL | Events, Booking, Payment, Tickets |
| **AI Service** | 8085 | PostgreSQL + pgvector | Chatbot, RAG |
| **Eureka** | 8761 | - | Service Discovery |
| **Config Server** | 8888 | - | Centralized Configuration |

---

# 2. ÄIá»‚M áº¤N TÆ¯á»¢NG GIáº¢NG VIÃŠN

## 2.1. Báº£ng Tá»•ng Há»£p "Selling Points"

| # | Äiá»ƒm áº¥n tÆ°á»£ng | Váº¥n Ä‘á» giáº£i quyáº¿t | CÃ´ng nghá»‡ | Äá»™ khÃ³ |
|---|---------------|-------------------|-----------|--------|
| 1 | **Redis Distributed Lock** | Flash Sale race condition | Redisson | â­â­â­â­ |
| 2 | **Event-Driven Architecture** | Async processing, loose coupling | Kafka | â­â­â­â­ |
| 3 | **RAG AI Chatbot** | Intelligent search & support | LangChain4j + pgvector | â­â­â­â­â­ |
| 4 | **OAuth2 + Keycloak** | Enterprise security | Keycloak | â­â­â­ |
| 5 | **Modular Monolith** | Clean architecture, refactor-ready | Package-by-feature | â­â­â­ |

---

## 2.2. Chi Tiáº¿t Tá»«ng Äiá»ƒm áº¤n TÆ°á»£ng

### ğŸ”¥ Äiá»ƒm 1: Redis Distributed Lock - Flash Sale

```
Váº¤N Äá»€ THá»°C Táº¾:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
"1000 ngÆ°á»i cÃ¹ng tranh mua 10 vÃ© VIP cuá»‘i cÃ¹ng trong 1 giÃ¢y"

Náº¿u khÃ´ng xá»­ lÃ½ â†’ OVER-BOOKING (bÃ¡n ra 100 vÃ© trong khi chá»‰ cÃ³ 10)
```

**Giáº£i phÃ¡p: Redisson Distributed Lock**

```java
// â­ CODE MáºªU - NÃªn demo khi báº£o vá»‡ Ä‘á»“ Ã¡n

@Service
@RequiredArgsConstructor
public class TicketReservationService {
    
    private final RedissonClient redissonClient;
    private final TicketTypeRepository ticketTypeRepository;
    
    private static final String LOCK_PREFIX = "lock:ticket:";
    
    public ReservationResult reserveTickets(Long ticketTypeId, int quantity, String orderId) {
        String lockKey = LOCK_PREFIX + ticketTypeId;
        RLock lock = redissonClient.getLock(lockKey);
        
        try {
            // Chá» tá»‘i Ä‘a 5s Ä‘á»ƒ láº¥y lock, giá»¯ lock tá»‘i Ä‘a 10s
            boolean acquired = lock.tryLock(5, 10, TimeUnit.SECONDS);
            
            if (!acquired) {
                return ReservationResult.failure("Há»‡ thá»‘ng Ä‘ang báº­n, vui lÃ²ng thá»­ láº¡i");
            }
            
            // === CRITICAL SECTION - Chá»‰ 1 thread Ä‘Æ°á»£c vÃ o ===
            
            TicketType ticketType = ticketTypeRepository.findById(ticketTypeId)
                .orElseThrow(() -> new NotFoundException("Loáº¡i vÃ© khÃ´ng tá»“n táº¡i"));
            
            if (ticketType.getQuantityAvailable() < quantity) {
                return ReservationResult.failure("KhÃ´ng Ä‘á»§ vÃ©");
            }
            
            // Trá»« inventory
            ticketType.setQuantityAvailable(
                ticketType.getQuantityAvailable() - quantity
            );
            ticketTypeRepository.save(ticketType);
            
            // Táº¡o reservation record
            Reservation reservation = createReservation(ticketTypeId, quantity, orderId);
            
            return ReservationResult.success(reservation);
            
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return ReservationResult.failure("Lá»—i há»‡ thá»‘ng");
        } finally {
            if (lock.isHeldByCurrentThread()) {
                lock.unlock();
            }
        }
    }
}
```

**Khi trÃ¬nh bÃ y vá»›i giáº£ng viÃªn:**
> *"Em xá»­ lÃ½ bÃ i toÃ¡n Flash Sale báº±ng Redis Distributed Lock vá»›i Redisson. Giáº£i phÃ¡p nÃ y Ä‘áº£m báº£o trong cÃ¹ng má»™t thá»i Ä‘iá»ƒm, chá»‰ cÃ³ duy nháº¥t 1 request Ä‘Æ°á»£c update inventory - trÃ¡nh hoÃ n toÃ n tÃ¬nh tráº¡ng over-booking. Pattern nÃ y Ä‘Æ°á»£c cÃ¡c sÃ n TMÄT lá»›n nhÆ° Shopee, Lazada Ã¡p dá»¥ng."*

---

### ğŸ”¥ Äiá»ƒm 2: Event-Driven Architecture (Kafka)

```
Váº¤N Äá»€ THá»°C Táº¾:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
"Sau khi thanh toÃ¡n thÃ nh cÃ´ng, cáº§n Ä‘á»“ng thá»i:
 1. PhÃ¡t hÃ nh vÃ© (táº¡o QR)
 2. Gá»­i email xÃ¡c nháº­n
 3. Update thá»‘ng kÃª cho Organizer
 4. Index vÃ o AI Ä‘á»ƒ chatbot biáº¿t

Náº¿u lÃ m Ä‘á»“ng bá»™ (sync) â†’ Cháº­m, 1 lá»—i = fail toÃ n bá»™"
```

**Giáº£i phÃ¡p: Kafka Event-Driven**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVENT-DRIVEN FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Payment Success                                                         â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Core Service â”‚â”€â”€â”€â”€â”€â–¶â”‚           KAFKA TOPIC                        â”‚  â”‚
â”‚  â”‚ (Producer)  â”‚      â”‚      "payment.success"                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚                                   â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚           â”‚                          â”‚                          â”‚       â”‚
â”‚           â–¼                          â–¼                          â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Ticket Issuer   â”‚    â”‚ Email Sender    â”‚    â”‚   AI Indexer    â”‚     â”‚
â”‚  â”‚   (Consumer)    â”‚    â”‚   (Consumer)    â”‚    â”‚   (Consumer)    â”‚     â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚     â”‚
â”‚  â”‚ â€¢ Generate QR   â”‚    â”‚ â€¢ Send confirm  â”‚    â”‚ â€¢ Index event   â”‚     â”‚
â”‚  â”‚ â€¢ Save ticket   â”‚    â”‚   email         â”‚    â”‚   for RAG       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Khi trÃ¬nh bÃ y:**
> *"Em Ã¡p dá»¥ng Event-Driven Architecture vá»›i Kafka. Khi thanh toÃ¡n thÃ nh cÃ´ng, Core Service publish 1 event, cÃ¡c consumers xá»­ lÃ½ song song vÃ  Ä‘á»™c láº­p. Náº¿u email service lá»—i, vÃ© váº«n Ä‘Æ°á»£c phÃ¡t hÃ nh bÃ¬nh thÆ°á»ng. ÄÃ¢y lÃ  pattern cá»§a cÃ¡c há»‡ thá»‘ng high-throughput nhÆ° Netflix, Uber."*

---

### ğŸ”¥ Äiá»ƒm 3: RAG AI Chatbot

```
Váº¤N Äá»€ THá»°C Táº¾:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
"Chatbot thÃ´ng thÆ°á»ng chá»‰ tráº£ lá»i theo script cá»©ng.
User há»i 'cÃ³ concert nháº¡c rock á»Ÿ SÃ i GÃ²n khÃ´ng?' â†’ Bot khÃ´ng biáº¿t"
```

**Giáº£i phÃ¡p: RAG (Retrieval-Augmented Generation)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RAG ARCHITECTURE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  User: "CÃ³ concert rock nÃ o á»Ÿ SG thÃ¡ng nÃ y khÃ´ng?"                      â”‚
â”‚                          â”‚                                               â”‚
â”‚                          â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Step 1: EMBED QUERY                                          â”‚        â”‚
â”‚  â”‚ "concert rock SG" â†’ [0.12, -0.34, 0.78, ...]  (1536-dim)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                          â”‚                                               â”‚
â”‚                          â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Step 2: VECTOR SEARCH (pgvector)                             â”‚        â”‚
â”‚  â”‚                                                               â”‚        â”‚
â”‚  â”‚ SELECT * FROM documents                                       â”‚        â”‚
â”‚  â”‚ ORDER BY embedding <=> query_embedding                        â”‚        â”‚
â”‚  â”‚ LIMIT 5;                                                      â”‚        â”‚
â”‚  â”‚                                                               â”‚        â”‚
â”‚  â”‚ Found:                                                        â”‚        â”‚
â”‚  â”‚ â€¢ "Rock Storm 2026 - 15/02 - SVÄ PhÃº Thá» - 800K"            â”‚        â”‚
â”‚  â”‚ â€¢ "Indie Rock Night - 22/02 - Cargo Bar - 300K"             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                          â”‚                                               â”‚
â”‚                          â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Step 3: GENERATE (OpenAI GPT)                                â”‚        â”‚
â”‚  â”‚                                                               â”‚        â”‚
â”‚  â”‚ System: "Tráº£ lá»i dá»±a trÃªn context: {retrieved_docs}"        â”‚        â”‚
â”‚  â”‚ User: "CÃ³ concert rock nÃ o á»Ÿ SG thÃ¡ng nÃ y khÃ´ng?"           â”‚        â”‚
â”‚  â”‚                                                               â”‚        â”‚
â”‚  â”‚ Bot: "CÃ³ 2 sá»± kiá»‡n rock táº¡i TPHCM thÃ¡ng 2:                  â”‚        â”‚
â”‚  â”‚       1. Rock Storm 2026 - 15/02 - GiÃ¡ tá»« 800.000Ä‘          â”‚        â”‚
â”‚  â”‚       2. Indie Rock Night - 22/02 - GiÃ¡ tá»« 300.000Ä‘"        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Khi trÃ¬nh bÃ y:**
> *"Chatbot cá»§a em sá»­ dá»¥ng RAG - Retrieval-Augmented Generation, má»™t ká»¹ thuáº­t AI tiÃªn tiáº¿n nÄƒm 2024. Thay vÃ¬ tráº£ lá»i cá»©ng nháº¯c, bot embed toÃ n bá»™ events vÃ o vector space, sau Ä‘Ã³ semantic search Ä‘á»ƒ tÃ¬m thÃ´ng tin liÃªn quan vÃ  sinh cÃ¢u tráº£ lá»i tá»± nhiÃªn. Äá»™ chÃ­nh xÃ¡c cao hÆ¡n nhiá»u so vá»›i keyword matching."*

---

### ğŸ”¥ Äiá»ƒm 4: OAuth2 + Keycloak

**Khi trÃ¬nh bÃ y:**
> *"Em sá»­ dá»¥ng Keycloak lÃ m Identity Provider thay vÃ¬ tá»± code authentication. Keycloak lÃ  giáº£i phÃ¡p cá»§a Red Hat, Ä‘Æ°á»£c dÃ¹ng bá»Ÿi nhiá»u enterprise. Há»— trá»£ OAuth2, OpenID Connect, vÃ  cÃ³ thá»ƒ tÃ­ch há»£p Google/Facebook login dá»… dÃ ng."*

---

### ğŸ”¥ Äiá»ƒm 5: Modular Monolith - Clean Architecture

**Khi trÃ¬nh bÃ y:**
> *"Core Service cá»§a em Ã¡p dá»¥ng Modular Monolith pattern - code Ä‘Æ°á»£c tá»• chá»©c thÃ nh cÃ¡c modules Ä‘á»™c láº­p (Event, Booking, Payment), giao tiáº¿p qua interface. DÃ¹ deploy chung nhÆ°ng cÃ³ thá»ƒ tÃ¡ch thÃ nh microservices riÃªng báº¥t cá»© lÃºc nÃ o mÃ  khÃ´ng cáº§n rewrite. ÄÃ¢y lÃ  pattern cá»§a Shopify giai Ä‘oáº¡n Ä‘áº§u."*

---

# 3. MESSAGE QUEUE ARCHITECTURE

## 3.1. Kafka Topics & Events

| Topic | Producer | Consumers | Purpose |
|-------|----------|-----------|---------|
| `payment.success` | Core Service | Ticket Issuer, Email, AI Indexer | Sau khi thanh toÃ¡n OK |
| `order.created` | Core Service | Analytics | Khi táº¡o Ä‘Æ¡n má»›i |
| `order.cancelled` | Core Service | Inventory Restorer | Khi há»§y Ä‘Æ¡n |
| `event.created` | Core Service | AI Service | Index cho RAG |
| `event.updated` | Core Service | AI Service | Re-index cho RAG |

## 3.2. Event Schemas

```java
// PaymentSuccessEvent.java
@Data
@Builder
public class PaymentSuccessEvent {
    private String orderId;
    private String orderNumber;
    private String userId;
    private Long eventId;
    private String eventTitle;
    private BigDecimal totalAmount;
    private List<TicketInfo> tickets;
    private LocalDateTime paidAt;
    
    @Data
    public static class TicketInfo {
        private Long ticketTypeId;
        private String ticketTypeName;
        private int quantity;
        private BigDecimal unitPrice;
    }
}
```

## 3.3. Producer Configuration (Core Service)

```java
@Service
@RequiredArgsConstructor
public class PaymentEventPublisher {
    
    private final StreamBridge streamBridge;
    
    public void publishPaymentSuccess(Order order) {
        PaymentSuccessEvent event = PaymentSuccessEvent.builder()
            .orderId(order.getId().toString())
            .orderNumber(order.getOrderNumber())
            .userId(order.getUserId())
            .eventId(order.getEventId())
            .totalAmount(order.getTotalAmount())
            .paidAt(LocalDateTime.now())
            .tickets(mapToTicketInfo(order.getItems()))
            .build();
        
        streamBridge.send("paymentSuccess-out-0", event);
        log.info("Published PaymentSuccessEvent for order: {}", order.getOrderNumber());
    }
}
```

## 3.4. Consumer Configuration (Core Service - Ticket Issuer)

```java
@Configuration
public class KafkaConsumerConfig {
    
    @Bean
    public Consumer<PaymentSuccessEvent> ticketIssuer(TicketService ticketService) {
        return event -> {
            log.info("Received PaymentSuccessEvent for order: {}", event.getOrderNumber());
            ticketService.issueTickets(event);
        };
    }
}

// application.yml
spring:
  cloud:
    stream:
      bindings:
        ticketIssuer-in-0:
          destination: payment.success
          group: ticket-issuer-group
        paymentSuccess-out-0:
          destination: payment.success
```

---

# 4. REDIS DISTRIBUTED LOCK - FLASH SALE

## 4.1. Setup Redisson

```xml
<!-- pom.xml -->
<dependency>
    <groupId>org.redisson</groupId>
    <artifactId>redisson-spring-boot-starter</artifactId>
    <version>3.27.0</version>
</dependency>
```

```yaml
# application.yml
spring:
  redis:
    host: localhost
    port: 6379
```

## 4.2. Redisson Configuration

```java
@Configuration
public class RedissonConfig {
    
    @Value("${spring.redis.host}")
    private String redisHost;
    
    @Value("${spring.redis.port}")
    private int redisPort;
    
    @Bean
    public RedissonClient redissonClient() {
        Config config = new Config();
        config.useSingleServer()
              .setAddress("redis://" + redisHost + ":" + redisPort)
              .setConnectionMinimumIdleSize(5)
              .setConnectionPoolSize(10);
        return Redisson.create(config);
    }
}
```

## 4.3. Complete Flash Sale Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLASH SALE BOOKING FLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  1. User clicks "Mua vÃ©"                                                â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  2. API: POST /api/bookings                                             â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 3. BookingService.createOrder()                                 â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚    a) Validate request                                          â”‚     â”‚
â”‚  â”‚    b) Create Order entity (status: PENDING)                     â”‚     â”‚
â”‚  â”‚    c) Call TicketReservationService.reserveTickets()            â”‚     â”‚
â”‚  â”‚         â”‚                                                        â”‚     â”‚
â”‚  â”‚         â–¼                                                        â”‚     â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚    â”‚ DISTRIBUTED LOCK (Redisson)                              â”‚  â”‚     â”‚
â”‚  â”‚    â”‚                                                          â”‚  â”‚     â”‚
â”‚  â”‚    â”‚ lock.tryLock(5s, 10s) â”€â”€â”                               â”‚  â”‚     â”‚
â”‚  â”‚    â”‚                         â”‚                                â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â”‚ CRITICAL SECTION                               â”‚    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â”‚ â€¢ Check quantity_available                     â”‚    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â”‚ â€¢ Decrement inventory                          â”‚    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â”‚ â€¢ Save to DB                                   â”‚    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚     â”‚
â”‚  â”‚    â”‚                         â”‚                                â”‚  â”‚     â”‚
â”‚  â”‚    â”‚ lock.unlock() â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â”‚     â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚    d) Save Order with items                                     â”‚     â”‚
â”‚  â”‚    e) Set expiration (15 minutes)                               â”‚     â”‚
â”‚  â”‚    f) Return order info                                         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  4. Frontend redirects to VNPay                                         â”‚
â”‚           â”‚                                                              â”‚
â”‚           â–¼                                                              â”‚
â”‚  5. VNPay callback â†’ Issue tickets â†’ Publish event                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# 5. REFACTORING GUIDE - SOURCE CODE HIá»†N Táº I

## 5.1. PhÃ¢n TÃ­ch Cáº¥u TrÃºc Hiá»‡n Táº¡i

```
ecom-application/                  # HIá»†N Táº I
â”œâ”€â”€ apigateway/                    âœ… GIá»® NGUYÃŠN
â”œâ”€â”€ configserver/                  âœ… GIá»® NGUYÃŠN  
â”œâ”€â”€ eureka/                        âœ… GIá»® NGUYÃŠN
â”œâ”€â”€ user/                          âš™ï¸ REFACTOR NHáº¸
â”œâ”€â”€ product/                       ğŸ”„ RENAME â†’ core-service
â”œâ”€â”€ order/                         ğŸ”„ MERGE VÃ€O core-service
â”œâ”€â”€ notification/                  âŒ XÃ“A/Gá»˜P
â””â”€â”€ docker-compose.yml             âš™ï¸ Cáº¬P NHáº¬T
```

## 5.2. Chi Tiáº¿t Refactoring Tá»«ng Service

### ğŸ“ USER SERVICE (Refactor nháº¹)

```
HIá»†N Táº I:                          SAU KHI REFACTOR:
user/src/main/java/                user-service/src/main/java/
â””â”€â”€ com/ecommerce/user/            â””â”€â”€ com/ticketbox/user/
    â”œâ”€â”€ UserApplication.java           â”œâ”€â”€ UserServiceApplication.java
    â”œâ”€â”€ controller/                    â”œâ”€â”€ controller/
    â”‚   â””â”€â”€ UserController.java        â”‚   â””â”€â”€ UserController.java
    â”œâ”€â”€ service/                       â”œâ”€â”€ service/
    â”‚   â”œâ”€â”€ UserService.java           â”‚   â”œâ”€â”€ UserService.java
    â”‚   â””â”€â”€ KeycloakAdminService.java  â”‚   â””â”€â”€ KeycloakUserService.java
    â”œâ”€â”€ model/                         â”œâ”€â”€ model/
    â”‚   â”œâ”€â”€ User.java                  â”‚   â”œâ”€â”€ User.java
    â”‚   â”œâ”€â”€ Address.java               â”‚   â”œâ”€â”€ Address.java
    â”‚   â””â”€â”€ UserRole.java              â”‚   â”œâ”€â”€ UserRole.java
    â”‚                                  â”‚   â””â”€â”€ OrganizerProfile.java  â† THÃŠM Má»šI
    â”œâ”€â”€ dto/                           â”œâ”€â”€ dto/
    â”‚   â”œâ”€â”€ UserRequest.java           â”‚   â”œâ”€â”€ UserRequest.java
    â”‚   â”œâ”€â”€ UserResponse.java          â”‚   â”œâ”€â”€ UserResponse.java
    â”‚   â””â”€â”€ AddressDTO.java            â”‚   â””â”€â”€ OrganizerProfileDTO.java â† THÃŠM Má»šI
    â””â”€â”€ repository/                    â””â”€â”€ repository/
        â””â”€â”€ UserRepository.java            â””â”€â”€ UserRepository.java

CHANGES:
 âœ… Rename package: com.ecommerce â†’ com.ticketbox
 âœ… Add OrganizerProfile (for organizer users)
 âœ… Enhance KeycloakAdminService for role management
```

---

### ğŸ“ CORE SERVICE (Major Refactor - Merge product + order)

```
HIá»†N Táº I (product/):               â”‚  HIá»†N Táº I (order/):
â””â”€â”€ com/ecommerce/product/         â”‚  â””â”€â”€ com/ecommerce/order/
    â”œâ”€â”€ ProductApplication.java    â”‚      â”œâ”€â”€ OrderApplication.java
    â”œâ”€â”€ controller/                â”‚      â”œâ”€â”€ controller/
    â”‚   â””â”€â”€ ProductController      â”‚      â”‚   â”œâ”€â”€ OrderController
    â”œâ”€â”€ model/                     â”‚      â”‚   â””â”€â”€ CartController
    â”‚   â””â”€â”€ Product.java           â”‚      â”œâ”€â”€ model/
    â”œâ”€â”€ dto/...                    â”‚      â”‚   â”œâ”€â”€ Order.java
    â”œâ”€â”€ service/...                â”‚      â”‚   â”œâ”€â”€ OrderItem.java
    â””â”€â”€ repository/...             â”‚      â”‚   â”œâ”€â”€ CartItem.java
                                   â”‚      â”‚   â””â”€â”€ OrderStatus.java
    XÃ“A Bá»                         â”‚      â”œâ”€â”€ client/  â† ÄÃƒ CÃ“
                                   â”‚      â”‚   â”œâ”€â”€ ProductServiceClient
                                   â”‚      â”‚   â””â”€â”€ UserServiceClient
                                   â”‚      â””â”€â”€ ...
                                   â”‚
                                   â”‚      GIá»® LÃ€M Ná»€N

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SAU KHI REFACTOR â†’ core-service/:
â””â”€â”€ com/ticketbox/core/
    â”‚
    â”œâ”€â”€ CoreServiceApplication.java
    â”‚
    â”œâ”€â”€ ğŸ“¦ event/                              # MODULE 1: EVENT
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”‚   â”œâ”€â”€ EventController.java          # Public APIs
    â”‚   â”‚   â””â”€â”€ OrganizerEventController.java # Organizer APIs
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â”œâ”€â”€ EventService.java
    â”‚   â”‚   â””â”€â”€ EventServiceImpl.java
    â”‚   â”œâ”€â”€ repository/
    â”‚   â”‚   â”œâ”€â”€ EventRepository.java
    â”‚   â”‚   â”œâ”€â”€ TicketTypeRepository.java
    â”‚   â”‚   â”œâ”€â”€ CategoryRepository.java
    â”‚   â”‚   â””â”€â”€ VenueRepository.java
    â”‚   â”œâ”€â”€ model/
    â”‚   â”‚   â”œâ”€â”€ Event.java
    â”‚   â”‚   â”œâ”€â”€ TicketType.java
    â”‚   â”‚   â”œâ”€â”€ Category.java
    â”‚   â”‚   â”œâ”€â”€ Venue.java
    â”‚   â”‚   â””â”€â”€ EventStatus.java
    â”‚   â”œâ”€â”€ dto/
    â”‚   â”‚   â”œâ”€â”€ EventRequest.java
    â”‚   â”‚   â”œâ”€â”€ EventResponse.java
    â”‚   â”‚   â”œâ”€â”€ TicketTypeDTO.java
    â”‚   â”‚   â””â”€â”€ EventSearchCriteria.java
    â”‚   â””â”€â”€ EventModuleApi.java               # â­ Interface cho module khÃ¡c gá»i
    â”‚
    â”œâ”€â”€ ğŸ“¦ booking/                            # MODULE 2: BOOKING
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”‚   â””â”€â”€ BookingController.java
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â”œâ”€â”€ BookingService.java
    â”‚   â”‚   â”œâ”€â”€ BookingServiceImpl.java
    â”‚   â”‚   â”œâ”€â”€ TicketReservationService.java # â­ Redis Lock á»Ÿ Ä‘Ã¢y
    â”‚   â”‚   â””â”€â”€ TicketService.java            # Issue tickets
    â”‚   â”œâ”€â”€ repository/
    â”‚   â”‚   â”œâ”€â”€ OrderRepository.java
    â”‚   â”‚   â”œâ”€â”€ OrderItemRepository.java
    â”‚   â”‚   â””â”€â”€ TicketRepository.java
    â”‚   â”œâ”€â”€ model/
    â”‚   â”‚   â”œâ”€â”€ Order.java
    â”‚   â”‚   â”œâ”€â”€ OrderItem.java
    â”‚   â”‚   â”œâ”€â”€ Ticket.java
    â”‚   â”‚   â””â”€â”€ OrderStatus.java
    â”‚   â”œâ”€â”€ dto/
    â”‚   â”‚   â”œâ”€â”€ BookingRequest.java
    â”‚   â”‚   â”œâ”€â”€ BookingResponse.java
    â”‚   â”‚   â”œâ”€â”€ TicketResponse.java
    â”‚   â”‚   â””â”€â”€ MyOrdersResponse.java
    â”‚   â””â”€â”€ BookingModuleApi.java
    â”‚
    â”œâ”€â”€ ğŸ“¦ payment/                            # MODULE 3: PAYMENT
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”‚   â””â”€â”€ PaymentController.java        # VNPay callbacks
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â”œâ”€â”€ PaymentService.java
    â”‚   â”‚   â”œâ”€â”€ VNPayService.java             # VNPay integration
    â”‚   â”‚   â””â”€â”€ PaymentEventPublisher.java    # Kafka producer
    â”‚   â”œâ”€â”€ repository/
    â”‚   â”‚   â””â”€â”€ PaymentRepository.java
    â”‚   â”œâ”€â”€ model/
    â”‚   â”‚   â””â”€â”€ Payment.java
    â”‚   â””â”€â”€ dto/
    â”‚       â””â”€â”€ VNPayCallbackDTO.java
    â”‚
    â”œâ”€â”€ ğŸ“¦ dashboard/                          # MODULE 4: ORGANIZER DASHBOARD
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”‚   â””â”€â”€ DashboardController.java
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â””â”€â”€ DashboardService.java
    â”‚   â””â”€â”€ dto/
    â”‚       â””â”€â”€ DashboardStats.java
    â”‚
    â””â”€â”€ ğŸ“¦ shared/                             # SHARED UTILITIES
        â”œâ”€â”€ config/
        â”‚   â”œâ”€â”€ RedissonConfig.java
        â”‚   â”œâ”€â”€ KafkaConfig.java
        â”‚   â””â”€â”€ SecurityConfig.java
        â”œâ”€â”€ exception/
        â”‚   â”œâ”€â”€ GlobalExceptionHandler.java
        â”‚   â”œâ”€â”€ NotFoundException.java
        â”‚   â””â”€â”€ BusinessException.java
        â””â”€â”€ util/
            â””â”€â”€ QrCodeGenerator.java
```

---

### ğŸ“ AI SERVICE (Táº¡o Má»›i)

```
ai-service/src/main/java/
â””â”€â”€ com/ticketbox/ai/
    â”‚
    â”œâ”€â”€ AiServiceApplication.java
    â”‚
    â”œâ”€â”€ ğŸ“¦ chat/
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”‚   â””â”€â”€ ChatController.java
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â”œâ”€â”€ ChatService.java
    â”‚   â”‚   â””â”€â”€ ConversationService.java
    â”‚   â”œâ”€â”€ model/
    â”‚   â”‚   â””â”€â”€ Conversation.java
    â”‚   â””â”€â”€ dto/
    â”‚       â”œâ”€â”€ ChatRequest.java
    â”‚       â””â”€â”€ ChatResponse.java
    â”‚
    â”œâ”€â”€ ğŸ“¦ rag/
    â”‚   â”œâ”€â”€ service/
    â”‚   â”‚   â”œâ”€â”€ RagService.java
    â”‚   â”‚   â”œâ”€â”€ EmbeddingService.java
    â”‚   â”‚   â””â”€â”€ DocumentIndexer.java
    â”‚   â”œâ”€â”€ repository/
    â”‚   â”‚   â””â”€â”€ DocumentRepository.java
    â”‚   â”œâ”€â”€ model/
    â”‚   â”‚   â””â”€â”€ Document.java
    â”‚   â””â”€â”€ consumer/
    â”‚       â””â”€â”€ EventIndexConsumer.java      # Kafka consumer
    â”‚
    â””â”€â”€ ğŸ“¦ config/
        â”œâ”€â”€ OpenAIConfig.java
        â””â”€â”€ PgVectorConfig.java
```

---

### ğŸ“ FRONTEND - REACTJS (Táº¡o Má»›i)

```
frontend/
â”œâ”€â”€ public/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/                           # API clients
â”‚   â”‚   â”œâ”€â”€ axiosClient.ts
â”‚   â”‚   â”œâ”€â”€ eventApi.ts
â”‚   â”‚   â”œâ”€â”€ bookingApi.ts
â”‚   â”‚   â””â”€â”€ chatApi.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                    # Reusable components
â”‚   â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ Event/
â”‚   â”‚   â”‚   â”œâ”€â”€ EventCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EventGrid.tsx
â”‚   â”‚   â”‚   â””â”€â”€ TicketSelector.tsx
â”‚   â”‚   â”œâ”€â”€ Chat/
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatWidget.tsx
â”‚   â”‚   â”‚   â””â”€â”€ MessageBubble.tsx
â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚       â”œâ”€â”€ Modal.tsx
â”‚   â”‚       â””â”€â”€ Loading.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                         # Page components
â”‚   â”‚   â”œâ”€â”€ Home/
â”‚   â”‚   â”œâ”€â”€ Events/
â”‚   â”‚   â”œâ”€â”€ EventDetail/
â”‚   â”‚   â”œâ”€â”€ Checkout/
â”‚   â”‚   â”œâ”€â”€ MyTickets/
â”‚   â”‚   â”œâ”€â”€ Organizer/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateEvent/
â”‚   â”‚   â”‚   â””â”€â”€ MyEvents/
â”‚   â”‚   â””â”€â”€ Auth/
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                         # Custom hooks
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ useEvents.ts
â”‚   â”‚   â””â”€â”€ useBooking.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ context/                       # React Context
â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx
â”‚   â”‚   â””â”€â”€ CartContext.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ App.tsx
â”‚   â””â”€â”€ main.tsx
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ tsconfig.json
```

---

## 5.3. Migration Steps - Thá»© Tá»± Thá»±c Hiá»‡n

```
PHASE 1: SETUP (Tuáº§n 1)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¡ Step 1: Táº¡o folder frontend/, init Vite + React + TypeScript
â–¡ Step 2: Rename product/ â†’ core-service/
â–¡ Step 3: Rename user/ â†’ user-service/  
â–¡ Step 4: XÃ³a folder notification/ (sáº½ merge logic vÃ o core-service)
â–¡ Step 5: Táº¡o folder ai-service/ (skeleton)
â–¡ Step 6: Update docker-compose.yml (thÃªm Redis)
â–¡ Step 7: Update configserver configs

PHASE 2: CORE SERVICE RESTRUCTURE (Tuáº§n 2)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¡ Step 1: Táº¡o package structure: event/, booking/, payment/, shared/
â–¡ Step 2: Move Product entities â†’ Event entities
â–¡ Step 3: Copy Order entities tá»« order/ cÅ© â†’ booking/
â–¡ Step 4: XÃ³a folder order/ cÅ©
â–¡ Step 5: Setup Redisson
â–¡ Step 6: Setup Kafka producers/consumers

PHASE 3: USER SERVICE UPDATE (Tuáº§n 2-3)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¡ Step 1: Add OrganizerProfile model
â–¡ Step 2: Enhance Keycloak integration
â–¡ Step 3: Update APIs for roles
```

---

# 6. TIMELINE CHI TIáº¾T 12 TUáº¦N

## 6.1. Overview Gantt

```
Tuáº§n    1    2    3    4    5    6    7    8    9   10   11   12
        â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
        â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼    â–¼
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        SPRINT 1          SPRINT 2          SPRINT 3
        Foundation        Booking+Pay       AI+Polish
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BE:    Setupâ”‚Event  â”‚Event+â”‚Bookingâ”‚Paymentâ”‚Ticket â”‚ AI  â”‚RAG  â”‚ Testâ”‚Docs
       Refactor    â”‚Searchâ”‚      â”‚      â”‚ QR    â”‚Setupâ”‚     â”‚     â”‚
       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FE:    Reactâ”‚Layout â”‚Event â”‚Event â”‚Checkout Paymentâ”‚Tickets Chat â”‚Polish Demo
       Setupâ”‚       â”‚List  â”‚Detailâ”‚       â”‚       â”‚     â”‚     â”‚     â”‚
```

## 6.2. Sprint Breakdown

### SPRINT 1: Foundation (Tuáº§n 1-4)

#### Tuáº§n 1: Setup & Refactoring

| Day | Backend | Frontend |
|-----|---------|----------|
| D1 | Rename folders, update packages | Init Vite + React + TS |
| D2 | Setup Core Service structure | TailwindCSS, routing setup |
| D3 | Setup Keycloak (Realm, Clients, Roles) | Keycloak-js integration |
| D4 | User Service: add OrganizerProfile | Layout components (Header, Footer) |
| D5 | Gateway security config | Login/Register pages |
| D6-7 | Testing, fixing | Testing, fixing |

#### Tuáº§n 2: Event Module

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | Event entities, repository | Event API client |
| D3-4 | Event CRUD APIs | Event listing page |
| D5 | Category, Venue APIs | Search & filter UI |
| D6-7 | Testing, documentation | Event card component |

#### Tuáº§n 3: Event Complete

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | Event search (JPA Specification) | Event detail page |
| D3-4 | TicketType APIs | Ticket selector component |
| D5 | Organizer event endpoints | Featured events section |
| D6-7 | Testing | Home page complete |

#### Tuáº§n 4: Organizer Features + Buffer

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | Event status workflow | Organizer: Create event form |
| D3-4 | Validation, Exception handling | Organizer: My events list |
| D5-7 | Sprint 1 review, bug fixes | Sprint 1 review, bug fixes |

**Sprint 1 Deliverables:**
- [x] User authentication vá»›i Keycloak
- [x] Browse, search, filter events
- [x] Event detail vá»›i ticket types
- [x] Organizer cÃ³ thá»ƒ táº¡o/quáº£n lÃ½ events

---

### SPRINT 2: Booking & Payment (Tuáº§n 5-8)

#### Tuáº§n 5: Booking Module

| Day | Backend | Frontend |
|-----|---------|----------|
| D1 | Setup Redisson (Redis) | Cart context setup |
| D2-3 | TicketReservationService vá»›i Distributed Lock | Ticket selection UI |
| D4-5 | BookingService, create order API | Order summary page |
| D6-7 | Order expiration job | Checkout page |

#### Tuáº§n 6: Payment Integration

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | VNPay service: create payment URL | Payment redirect handling |
| D3-4 | VNPay return handler, IPN | Payment result pages |
| D5 | Kafka: PaymentSuccessEvent | |
| D6-7 | Testing payment flow | Testing full flow |

#### Tuáº§n 7: Ticket Issuance

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | TicketService, QR generation | My Tickets page |
| D3-4 | Kafka consumer: issue tickets | Ticket detail + QR |
| D5 | My tickets API | Order history |
| D6-7 | Testing | Testing |

#### Tuáº§n 8: Dashboard + Polish

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | Dashboard APIs | Dashboard UI |
| D3-4 | Orders by event API | Sales statistics |
| D5-7 | Sprint 2 review, bug fixes | Sprint 2 review |

**Sprint 2 Deliverables:**
- [x] Complete booking flow
- [x] VNPay integration working
- [x] Tickets with QR code
- [x] Organizer dashboard
- [x] No over-booking (Distributed Lock)

---

### SPRINT 3: AI & Polish (Tuáº§n 9-12)

#### Tuáº§n 9: AI Service Setup

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | Create ai-service, pgvector | Chat widget component |
| D3-4 | OpenAI integration, basic chat | Chat interface |
| D5-7 | Testing chatbot | Integration |

#### Tuáº§n 10: RAG Implementation

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-2 | LangChain4j, embedding service | Improve chat UX |
| D3-4 | Document indexing pipeline | Suggested questions |
| D5-7 | RAG query flow | Testing |

#### Tuáº§n 11: Testing & Documentation

| Day | Backend | Frontend |
|-----|---------|----------|
| D1-3 | Integration tests | UI polish |
| D4-5 | API docs (Swagger) | Responsive design |
| D6-7 | README files | README |

#### Tuáº§n 12: Demo Preparation

| Day | Both |
|-----|------|
| D1-2 | Seed demo data |
| D3-4 | Presentation slides |
| D5 | Demo rehearsal |
| D6-7 | Final fixes, backup |

**Sprint 3 Deliverables:**
- [x] AI Chatbot working
- [x] RAG answers based on real events
- [x] Complete documentation
- [x] Demo ready

---

## 6.3. Risk Mitigation Checkpoints

| Week | Checkpoint | Mitigation if behind |
|------|------------|---------------------|
| 4 | Sprint 1 done? | Cut organizer features, focus MVP |
| 8 | Payment working? | Use mock payment if VNPay issues |
| 10 | RAG working? | Fall back to basic chatbot (no RAG) |
| 12 | Demo ready? | Prepare recorded video as backup |

---

# TÃ“M Táº®T ÄIá»€U HÃ€NH

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXECUTIVE SUMMARY                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  TECH STACK:                                                            â”‚
â”‚  â”œâ”€â”€ Backend: Spring Boot 3.5 + Java 24                                 â”‚
â”‚  â”œâ”€â”€ Frontend: React 18 + TypeScript + Vite                             â”‚
â”‚  â”œâ”€â”€ Auth: Keycloak + OAuth2                                            â”‚
â”‚  â”œâ”€â”€ Database: PostgreSQL + MongoDB + pgvector                          â”‚
â”‚  â”œâ”€â”€ Cache/Lock: Redis + Redisson                                       â”‚
â”‚  â”œâ”€â”€ Messaging: Kafka                                                   â”‚
â”‚  â””â”€â”€ AI: LangChain4j + OpenAI                                           â”‚
â”‚                                                                          â”‚
â”‚  KIáº¾N TRÃšC: 3 Services (User + Core + AI)                               â”‚
â”‚  â”œâ”€â”€ Modular Monolith trong Core Service                                â”‚
â”‚  â”œâ”€â”€ Package-by-feature, refactor-ready                                 â”‚
â”‚  â””â”€â”€ Event-driven vá»›i Kafka                                             â”‚
â”‚                                                                          â”‚
â”‚  ÄIá»‚M áº¤N TÆ¯á»¢NG:                                                         â”‚
â”‚  â”œâ”€â”€ 1. Redis Distributed Lock - Flash Sale                             â”‚
â”‚  â”œâ”€â”€ 2. Event-Driven Architecture - Kafka                               â”‚
â”‚  â”œâ”€â”€ 3. RAG AI Chatbot - pgvector + LangChain4j                        â”‚
â”‚  â”œâ”€â”€ 4. OAuth2 + Keycloak                                               â”‚
â”‚  â””â”€â”€ 5. Modular Monolith - Clean Architecture                          â”‚
â”‚                                                                          â”‚
â”‚  TIMELINE:                                                               â”‚
â”‚  â”œâ”€â”€ Sprint 1 (W1-4): Foundation + Event                                â”‚
â”‚  â”œâ”€â”€ Sprint 2 (W5-8): Booking + Payment â† MVP HOÃ€N THÃ€NH               â”‚
â”‚  â””â”€â”€ Sprint 3 (W9-12): AI + Polish                                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Document version: 3.0 | Last updated: 2026-02-03*
